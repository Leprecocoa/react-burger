(this["webpackJsonpreact-burger"]=this["webpackJsonpreact-burger"]||[]).push([[0],{17:function(e,t,n){e.exports={header:"header_header__2PCJV",nav:"header_nav__Yn7D9",navLink:"header_navLink__2qrHS",navLinkInactive:"header_navLinkInactive__cWiao",auth:"header_auth__1ZnS3"}},179:function(e,t,n){"use strict";n.r(t);var c=n(0),r=n.n(c),i=n(23),a=n.n(i),s=(n(98),n(6)),d=n(17),o=n.n(d),l=n(1);var u=function(){return Object(l.jsxs)("header",{className:"".concat(o.a.header," p-4"),children:[Object(l.jsxs)("nav",{className:o.a.nav,children:[Object(l.jsxs)("button",{className:"".concat(o.a.navLink," pr-5 pt-4 pb-4 mr-2"),children:[Object(l.jsx)(s.BurgerIcon,{type:"primary"}),Object(l.jsx)("span",{className:"text text_type_main-default ml-2",children:"\u041a\u043e\u043d\u0441\u0442\u0440\u0443\u043a\u0442\u043e\u0440"})]}),Object(l.jsxs)("button",{className:"".concat(o.a.navLink," pl-5 pr-5 pt-4 pb-4"),children:[Object(l.jsx)(s.ListIcon,{type:"secondary"}),Object(l.jsx)("span",{className:"text text_type_main-default ml-2 ".concat(o.a.navLinkInactive),children:"\u041b\u0435\u043d\u0442\u0430 \u0437\u0430\u043a\u0430\u0437\u043e\u0432"})]})]}),Object(l.jsx)(s.Logo,{}),Object(l.jsx)("div",{className:o.a.auth,children:Object(l.jsxs)("button",{className:"".concat(o.a.navLink," pl-5 pr-5 pt-4 pb-4"),children:[Object(l.jsx)(s.ProfileIcon,{type:"secondary"}),Object(l.jsx)("span",{className:"text text_type_main-default ml-2 ".concat(o.a.navLinkInactive),children:"\u041b\u0438\u0447\u043d\u044b\u0439 \u043a\u0430\u0431\u0438\u043d\u0435\u0442"})]})})]})},b=n(86),j=n.n(b),_=n(87),m=n.n(_),O=n(39),g=n.n(O),p=n.p+"static/media/check.2022ce2b.svg";function x(e){var t=e.order;return t?Object(l.jsxs)("div",{className:"".concat(g.a.details," pb-30"),children:[Object(l.jsx)("p",{className:"".concat(g.a.digits," text text_type_digits-large mb-8"),children:t.number}),Object(l.jsx)("p",{className:"text text_type_main-medium",children:"\u0438\u0434\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0440 \u0437\u0430\u043a\u0430\u0437\u0430"}),Object(l.jsx)("img",{className:"".concat(g.a.checkmark," mt-15 mb-15"),src:p,alt:"order-details"}),Object(l.jsx)("p",{className:"text text_type_main-default mb-2",children:"\u0412\u0430\u0448 \u0437\u0430\u043a\u0430\u0437 \u043d\u0430\u0447\u0430\u043b\u0438 \u0433\u043e\u0442\u043e\u0432\u0438\u0442\u044c"}),Object(l.jsx)("p",{className:"text text_type_main-default text_color_inactive",children:"\u0414\u043e\u0436\u0434\u0438\u0442\u0435\u0441\u044c \u0433\u043e\u0442\u043e\u0432\u043d\u043e\u0441\u0442\u0438 \u043d\u0430 \u043e\u0440\u0431\u0438\u0442\u0430\u043b\u044c\u043d\u043e\u0439 \u0441\u0442\u0430\u043d\u0446\u0438\u0438"})]}):null}var f=n(29),h=n.n(f),v=n(8),y=n.n(v);y.a.shape({calories:y.a.number.isRequired,carbohydrates:y.a.number.isRequired,fat:y.a.number.isRequired,image:y.a.string.isRequired,image_large:y.a.string.isRequired,image_mobile:y.a.string.isRequired,name:y.a.string.isRequired,price:y.a.number.isRequired,proteins:y.a.number.isRequired,type:y.a.string.isRequired,_id:y.a.string.isRequired,count:y.a.number});function N(e){var t=e.ingredient||{},n=t.image_large,c=t.name,r=t.calories,i=t.proteins,a=t.fat,s=t.carbohydrates;return Object(l.jsx)("div",{className:"".concat(h.a.details," pt-10 pb-15"),children:Object(l.jsxs)("div",{className:h.a.content,children:[Object(l.jsx)("img",{className:h.a.image,src:n,alt:c}),Object(l.jsx)("p",{className:"text text_type_main-medium mt-4 mb-8",children:c}),Object(l.jsxs)("ul",{className:h.a.list,children:[Object(l.jsxs)("li",{children:[Object(l.jsx)("p",{className:"text text_type_main-default text_color_inactive mb-2",children:"\u041a\u0430\u043b\u043e\u0440\u0438\u0438,\u043a\u043a\u0430\u043b"}),Object(l.jsx)("span",{className:"text text_type_digits-default text_color_inactive",children:r})]}),Object(l.jsxs)("li",{children:[Object(l.jsx)("p",{className:"text text_type_main-default text_color_inactive mb-2",children:"\u0411\u0435\u043b\u043a\u0438, \u0433"}),Object(l.jsx)("span",{className:"text text_type_digits-default text_color_inactive",children:i})]}),Object(l.jsxs)("li",{children:[Object(l.jsx)("p",{className:"text text_type_main-default text_color_inactive mb-2",children:"\u0416\u0438\u0440\u044b, \u0433"}),Object(l.jsx)("span",{className:"text text_type_digits-default text_color_inactive",children:a})]}),Object(l.jsxs)("li",{children:[Object(l.jsx)("p",{className:"text text_type_main-default text_color_inactive mb-2",children:"\u0423\u0433\u043b\u0435\u0432\u043e\u0434\u044b, \u0433"}),Object(l.jsx)("span",{className:"text text_type_digits-default text_color_inactive",children:s})]})]})]})})}var E=n(40),I=n.n(E),C=n(88),k=n.n(C);function R(e){var t=e.onClick;return Object(l.jsx)("div",{className:k.a.overlay,onClick:t})}function T(e){var t=e.children,n=e.title,r=e.onClose,a=e.isVisible;return Object(c.useEffect)((function(){if(a){var e=function(e){"Escape"===e.key&&r()};return document.addEventListener("keydown",e),function(){document.removeEventListener("keydown",e)}}}),[r,a]),a?Object(i.createPortal)(Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)(R,{onClick:r}),Object(l.jsxs)("div",{className:"".concat(I.a.modal," pr-10 pl-10 pt-10"),children:[Object(l.jsxs)("div",{className:I.a.header,children:[Object(l.jsx)("h2",{className:"text text_type_main-large",children:n}),Object(l.jsx)("button",{className:I.a.close,onClick:r,children:Object(l.jsx)(s.CloseIcon,{type:"primary"})})]}),t]})]}),document.querySelector("#modals")):null}var S=n(15),D=n(26),L=n(3),q=n(9),w=n(185),F=n(63),G=n.n(F),B=Object(c.forwardRef)((function(e,t){var n=e.ingredient,r=e.onIngredientClick,i=e.count,a=Object(c.useCallback)((function(){r(n)}),[r,n]);return Object(l.jsxs)("section",{className:G.a.ingredient_card,onClick:a,ref:t,children:[Object(l.jsx)(s.Counter,{count:i,size:"small"}),Object(l.jsx)("img",{src:n.image,alt:n.name}),Object(l.jsxs)("div",{className:"".concat(G.a.price," mt-1 mb-1"),children:[Object(l.jsx)("span",{className:"text text_type_main-default mr-2",children:n.price})," ",Object(l.jsx)(s.CurrencyIcon,{type:"primary"})]}),Object(l.jsx)("p",{children:n.name})]})}));var P=function(e){var t=e.ingredient,n=e.onIngredientClick,c=e.count,r=Object(w.a)({type:"ingredient",item:{ingredient:t}}),i=Object(S.a)(r,2)[1];return Object(l.jsx)(B,{ingredient:t,onIngredientClick:n,count:c,ref:i})},U=n(41),V=n.n(U),M=Object(c.forwardRef)((function(e,t){var n=e.title,c=e.ingredients,r=e.type,i=e.onIngredientClick,a=e.counts;return Object(l.jsxs)("section",{ref:t,className:"".concat(V.a.ingredients_list," pt-10"),children:[Object(l.jsx)("h2",{className:"".concat(V.a.ingredients_list_title," mb-6 text text_type_main-medium"),children:n}),Object(l.jsx)("div",{className:"".concat(V.a.cards_box," pl-4 pr-4"),children:c.filter((function(e){return e.type===r})).map((function(e){return Object(l.jsx)(P,{ingredient:e,onIngredientClick:i,count:a[e._id]},e._id)}))})]})})),A=n(30),J=n.n(A);var z=function(e){var t=e.handleIngredientDetailsOpen,n=e.ingredients,r=Object(q.c)((function(e){var t=e.burgerConstructor;return{selectedIngredients:t.selectedIngredients,selectedBun:t.selectedBun}})),i=r.selectedIngredients,a=r.selectedBun,d=Object(c.useMemo)((function(){return n.reduce((function(e,t){return"bun"===t.type?Object(L.a)(Object(L.a)({},e),{},Object(D.a)({},t._id,a&&t._id===a._id?1:0)):Object(L.a)(Object(L.a)({},e),{},Object(D.a)({},t._id,i.filter((function(e){return e._id===t._id})).length))}),{})}),[n,i,a]),o=Object(c.useState)("bun"),u=Object(S.a)(o,2),b=u[0],j=u[1],_=Object(c.useRef)(),m=Object(c.useRef)(),O=Object(c.useRef)(),g=Object(c.useCallback)((function(){return j("bun")}),[j]),p=Object(c.useCallback)((function(){return j("sauce")}),[j]),x=Object(c.useCallback)((function(){return j("main")}),[j]),f=Object(c.useCallback)((function(e){var t=e.target.scrollTop,n=m.current.offsetTop,c=O.current.offsetTop;t+200<=n?g():t+200<=c?p():x()}),[g,x,p]);return Object(l.jsxs)("section",{className:"".concat(J.a.ingredients_section," pt-10 mr-10"),children:[Object(l.jsx)("h1",{className:"text text_type_main-large",children:"\u0421\u043e\u0431\u0435\u0440\u0438\u0442\u0435 \u0431\u0443\u0440\u0433\u0435\u0440"}),Object(l.jsxs)("div",{className:"".concat(J.a.ingredients_tabs," pt-5"),children:[Object(l.jsx)(s.Tab,{value:"bun",active:"bun"===b,onClick:g,children:"\u0411\u0443\u043b\u043a\u0438"}),Object(l.jsx)(s.Tab,{value:"sauce",active:"sauce"===b,onClick:p,children:"\u0421\u043e\u0443\u0441\u044b"}),Object(l.jsx)(s.Tab,{value:"main",active:"main"===b,onClick:x,children:"\u041d\u0430\u0447\u0438\u043d\u043a\u0438"})]}),Object(l.jsxs)("div",{className:"".concat(J.a.scrollbox," ").concat(J.a.scrollbar),onScroll:f,children:[Object(l.jsx)(M,{ref:_,title:"\u0411\u0443\u043b\u043a\u0438",type:"bun",ingredients:n,counts:d,onIngredientClick:t},"bun"),Object(l.jsx)(M,{ref:m,title:"\u0421\u043e\u0443\u0441\u044b",type:"sauce",ingredients:n,counts:d,onIngredientClick:t},"sauce"),Object(l.jsx)(M,{ref:O,title:"\u041d\u0430\u0447\u0438\u043d\u043a\u0438",type:"main",ingredients:n,counts:d,onIngredientClick:t},"main")]})]})},Y=n(186),X=n(20),H=n.n(X),Z="https://norma.nomoreparties.space/api",Q=function(e){return e&&e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))};var W="GET_INGREDIENTS_REQUEST",K="GET_INGREDIENTS_SUCCESS",$="GET_INGREDIENTS_FAILED",ee="SELECT_INGREDIENT",te="DELETE_SELECTED_INGREDIENT_DATA",ne="GET_ORDER_NUMBER_REQUEST",ce="GET_ORDER_NUMBER_SUCCESS",re="GET_ORDER_NUMBER_FAILED",ie="DELETE_ORDER_DATA",ae="DROP_INGREDIENT",se="DELETE_IGREDIENT",de="REORDER_CONSTRUCTOR_ITEM";function oe(){return function(e){e({type:W}),fetch("".concat(Z,"/ingredients")).then((function(e){return Q(e)})).then((function(t){t&&t.success?e({type:K,payload:{ingredients:t.data}}):e({type:$})}))}}function le(e){return function(t){t({type:ne}),function(e){return fetch("".concat(Z,"/orders"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({ingredients:e})}).then((function(e){return Q(e)})).then((function(e){return e}))}(e).then((function(e){e&&e.success?t({type:ce,payload:{order:e.order}}):t({type:re})}))}}var ue=n(42),be=n.n(ue),je=Object(c.forwardRef)((function(e,t){var n=e.ingredient,r=e.index,i=e.handleDelete,a=Object(c.useCallback)((function(){return i(r)}),[i,r]);return Object(l.jsxs)("div",{className:"".concat(be.a.constructor_item," mb-4 pl-8"),ref:t,children:[Object(l.jsx)("div",{className:be.a.ingredient_button,children:Object(l.jsx)("button",{className:be.a.drag_button,children:Object(l.jsx)(s.DragIcon,{type:"primary"})})}),Object(l.jsx)(s.ConstructorElement,{text:n.name,price:n.price,thumbnail:n.image,handleClose:a})]})}));var _e=function(e){var t=e.ingredient,n=e.index,r=e.handleDelete,i=Object(c.useRef)(null),a=Object(q.b)(),s=Object(w.a)({type:"constructor-item",item:{dragIndex:n}}),d=Object(S.a)(s,2)[1],o=Object(Y.a)({accept:"constructor-item",drop:function(e){var t=e.dragIndex;a({type:de,payload:{itemIndex:n,dragIndex:t}})}}),u=Object(S.a)(o,2)[1];return Object(c.useEffect)((function(){d(u(i))}),[d,u]),Object(l.jsx)(je,{ingredient:t,index:n,handleDelete:r,ref:i})},me=Object(c.forwardRef)((function(e,t){var n=e.onSubmit,r=e.ingredients,i=Object(q.b)(),a=Object(q.c)((function(e){return e.burgerConstructor.selectedIngredients})),d=Object(q.c)((function(e){return e.burgerConstructor.selectedBun})),o=Object(c.useMemo)((function(){return a.reduce((function(e,t){return e+t.price}),d?d.price:0)}),[a,d]),u=Object(c.useCallback)((function(){d&&n(a.concat(d))}),[n,a,d]),b=Object(c.useCallback)((function(e){i({type:se,payload:{deleteIndex:e}})}),[i]);return 0===r.length?null:Object(l.jsxs)("section",{className:"".concat(H.a.constructor_section," pt-25"),ref:t,children:[Object(l.jsxs)("div",{className:H.a.constructor_list,children:[d&&Object(l.jsx)("div",{className:"pl-9 pr-4",children:Object(l.jsx)(s.ConstructorElement,{type:"top",isLocked:!0,text:"".concat(d.name," (\u0432\u0435\u0440\u0445)"),price:d.price,thumbnail:d.image})}),Object(l.jsx)("div",{className:"".concat(H.a.constructor_items," ").concat(H.a.scrollbar,"  mt-4 mb-4 pl-4 pr-4"),children:a.map((function(e,t){return Object(l.jsx)(_e,{ingredient:e,index:t,handleDelete:b},"".concat(e._id).concat(t))}))}),d?Object(l.jsx)("div",{className:"pl-9 pr-4",children:Object(l.jsx)(s.ConstructorElement,{type:"bottom",isLocked:!0,text:"".concat(d.name," (\u043d\u0438\u0437)"),price:d.price,thumbnail:d.image})}):null]}),Object(l.jsxs)("div",{className:"".concat(H.a.order," pt-10"),children:[Object(l.jsxs)("div",{className:"".concat(H.a.order_price," mr-10"),children:[Object(l.jsx)("span",{className:"text text_type_digits-medium mr-2",children:o}),Object(l.jsx)(s.CurrencyIcon,{type:"primary"})]}),Object(l.jsx)(s.Button,{type:"primary",size:"large",onClick:u,children:"\u041e\u0444\u043e\u0440\u043c\u0438\u0442\u044c \u0437\u0430\u043a\u0430\u0437"})]})]})}));var Oe=function(e){var t=e.onSubmit,n=e.ingredients,c=Object(q.b)(),r=Object(Y.a)({accept:"ingredient",drop:function(e){var t=e.ingredient;c({type:ae,payload:{ingredient:t}})}}),i=Object(S.a)(r,2)[1];return Object(l.jsx)(me,{onSubmit:t,ingredients:n,ref:i})};var ge=function(){var e=Object(q.b)(),t=Object(q.c)((function(e){var t=e.ingredients;return{ingredients:t.ingredients,selectedIngredient:t.selectedIngredient,order:e.order.order}})),n=t.ingredients,r=t.selectedIngredient,i=t.order,a=Object(c.useCallback)((function(t){e({type:ee,payload:{ingredient:t}})}),[e]),s=Object(c.useCallback)((function(){e({type:te})}),[e]);Object(c.useEffect)((function(){e(oe())}),[e]);var d=Object(c.useCallback)((function(t){e(le(t.map((function(e){return e._id}))))}),[e]),o=Object(c.useCallback)((function(){e({type:ie})}),[e]);return Object(l.jsxs)("main",{className:"".concat(m.a.main," pb-10"),children:[Object(l.jsx)(z,{handleIngredientDetailsOpen:a,ingredients:n}),Object(l.jsx)(Oe,{onSubmit:d,ingredients:n}),Object(l.jsx)(T,{isVisible:!!r,onClose:s,title:"\u0414\u0435\u0442\u0430\u043b\u0438 \u0438\u043d\u0433\u0440\u0435\u0434\u0438\u0435\u043d\u0442\u0430",children:Object(l.jsx)(N,{ingredient:r})}),Object(l.jsx)(T,{isVisible:!!i,onClose:o,children:Object(l.jsx)(x,{order:i})})]})};var pe=function(){return Object(l.jsxs)("div",{className:j.a.page,children:[Object(l.jsx)(u,{}),Object(l.jsx)(ge,{})]})},xe=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,187)).then((function(t){var n=t.getCLS,c=t.getFID,r=t.getFCP,i=t.getLCP,a=t.getTTFB;n(e),c(e),r(e),i(e),a(e)}))},fe=n(16),he="object"===typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__({}):fe.c,ve=n(91),ye=n(66),Ne={ingredients:[],ingredientsRequest:!1,ingredientsFailed:!1,selectedIngredient:null},Ee={selectedIngredients:[],selectedBun:null},Ie={order:null,orderNumberRequest:!1,orderNumberFailed:!1},Ce=Object(fe.b)({order:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ie,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case ne:return Object(L.a)(Object(L.a)({},e),{},{orderNumberRequest:!0});case ce:return Object(L.a)(Object(L.a)({},e),{},{orderNumberRequest:!1,orderNumberFailed:!1,order:t.payload.order});case re:return Object(L.a)(Object(L.a)({},Ie),{},{orderNumberFailed:!0});case ie:return Object(L.a)(Object(L.a)({},e),{},{order:null});default:return e}},ingredients:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ne,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case W:return Object(L.a)(Object(L.a)({},e),{},{ingredientsFailed:!1,ingredientsRequest:!0});case K:return Object(L.a)(Object(L.a)({},e),{},{ingredientsFailed:!1,ingredientsRequest:!1,ingredients:t.payload.ingredients});case $:return Object(L.a)(Object(L.a)({},Ne),{},{ingredientsFailed:!0});case ee:return Object(L.a)(Object(L.a)({},e),{},{selectedIngredient:t.payload.ingredient});case te:return Object(L.a)(Object(L.a)({},e),{},{selectedIngredient:null});default:return e}},burgerConstructor:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ee,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case ae:var n=t.payload.ingredient;return"bun"===n.type?Object(L.a)(Object(L.a)({},e),{},{selectedBun:n}):Object(L.a)(Object(L.a)({},e),{},{selectedIngredients:[].concat(Object(ye.a)(e.selectedIngredients),[n])});case se:return Object(L.a)(Object(L.a)({},e),{},{selectedIngredients:e.selectedIngredients.filter((function(e,n){return n!==t.payload.deleteIndex}))});case de:var c=t.payload,r=c.dragIndex,i=c.itemIndex,a=Object(ye.a)(e.selectedIngredients),s=a[r];return a[r]=a[i],a[i]=s,Object(L.a)(Object(L.a)({},e),{},{selectedIngredients:a});default:return e}}}),ke=n(184),Re=n(92),Te=he(Object(fe.a)(ve.a)),Se=Object(fe.d)(Ce,Te);a.a.render(Object(l.jsx)(r.a.StrictMode,{children:Object(l.jsx)(q.a,{store:Se,children:Object(l.jsx)(ke.a,{backend:Re.a,children:Object(l.jsx)(pe,{})})})}),document.getElementById("root")),xe()},20:function(e,t,n){e.exports={constructor_section:"burger-constructor_constructor_section__3FdfH",constructor_list:"burger-constructor_constructor_list__2mBcy",constructor_items:"burger-constructor_constructor_items__2t2yl",order:"burger-constructor_order__SsnH4",scrollbox:"burger-constructor_scrollbox__3Z23P",scrollbar:"burger-constructor_scrollbar__-c9tN"}},29:function(e,t,n){e.exports={details:"ingredient-details_details__28kCX",content:"ingredient-details_content__1TZrm",image:"ingredient-details_image__3EkJL",list:"ingredient-details_list__3jN0U"}},30:function(e,t,n){e.exports={ingredients_section:"burger-ingredients_ingredients_section__l8mYY",ingredients_tabs:"burger-ingredients_ingredients_tabs__1zFeW",scrollbox:"burger-ingredients_scrollbox__2apTV",scrollbar:"burger-ingredients_scrollbar__2rVSV"}},39:function(e,t,n){e.exports={details:"order-details_details__2Chva",checkmark:"order-details_checkmark__3mkme",digits:"order-details_digits__33cjV"}},40:function(e,t,n){e.exports={modal:"modal_modal__-GJUR",header:"modal_header__2r55q",close:"modal_close__VSo9S"}},41:function(e,t,n){e.exports={ingredients_list:"ingredients-section_ingredients_list__1mz_n",ingredients_list_title:"ingredients-section_ingredients_list_title__2YZ9h",cards_box:"ingredients-section_cards_box__1j8gA"}},42:function(e,t,n){e.exports={constructor_item:"burger-constructor-item_constructor_item__N6dYK",ingredient_button:"burger-constructor-item_ingredient_button__1wYRz",drag_button:"burger-constructor-item_drag_button__2w73P"}},63:function(e,t,n){e.exports={ingredient_card:"ingredient-card_ingredient_card__1DunG",price:"ingredient-card_price__zyJet"}},86:function(e,t,n){e.exports={page:"app_page__1NvGu"}},87:function(e,t,n){e.exports={main:"main_main__OFmn0"}},88:function(e,t,n){e.exports={overlay:"modal-overlay_overlay__3PHOs"}},98:function(e,t,n){}},[[179,1,2]]]);
//# sourceMappingURL=main.25e883fd.chunk.js.map