(this["webpackJsonpreact-burger"]=this["webpackJsonpreact-burger"]||[]).push([[0],{11:function(e,t,r){e.exports={form__block:"pages_form__block__2hBXl",form:"pages_form__8Bp6z",login:"pages_login__2A9qH"}},116:function(e,t,r){e.exports={page:"app_page__1NvGu"}},117:function(e,t,r){e.exports={main:"main_main__OFmn0"}},118:function(e,t,r){e.exports={overlay:"modal-overlay_overlay__3PHOs"}},131:function(e,t,r){},16:function(e,t,r){e.exports={feed_page_grid:"feed-page_feed_page_grid__Vikiu",feed_item_link:"feed-page_feed_item_link__1kl-d",order_list:"feed-page_order_list__2I1AI",profile_order_list:"feed-page_profile_order_list__2rbES",scrollbar:"feed-page_scrollbar__mEWuG",main:"feed-page_main__1hb7L",nav:"feed-page_nav__182tQ",active_link:"feed-page_active_link__2NlO4",navlink:"feed-page_navlink__38GtK",logout:"feed-page_logout__1moNw",form:"feed-page_form__2yrPd"}},17:function(e,t,r){e.exports={order_details:"order-details_order_details__30Xux",order_info:"order-details_order_info__1WnlA",order_number:"order-details_order_number__2KM1t",order_title:"order-details_order_title__3IMck",order_status_in_progress:"order-details_order_status_in_progress__Ny-55",order_status_done:"order-details_order_status_done__9VZiT",order_ingredients_list:"order-details_order_ingredients_list__1s1Ys",order_ingredients_listitem:"order-details_order_ingredients_listitem__3nidA",ingredient_details:"order-details_ingredient_details__2faI4",ingredient_title:"order-details_ingredient_title__1wgmU",ingredient_cost:"order-details_ingredient_cost__35lyS",order_date:"order-details_order_date__2XUO9",order_sum:"order-details_order_sum__n7g2z"}},20:function(e,t,r){e.exports={order_numbers_feed:"order-number-feed_order_numbers_feed__2sZ9r",order_numbers:"order-number-feed_order_numbers__TM2fq",order_numbers_ready:"order-number-feed_order_numbers_ready__awPa6",order_numbers_ready_list:"order-number-feed_order_numbers_ready_list__1t2lD",list_item:"order-number-feed_list_item__2AiXK",order_numbers_list_item:"order-number-feed_order_numbers_list_item__1cjZ-",order_numbers_inprogress_list:"order-number-feed_order_numbers_inprogress_list__2Gjgf order-number-feed_order_numbers_ready_list__1t2lD",order_numbers_inprogress:"order-number-feed_order_numbers_inprogress__3YRd- order-number-feed_order_numbers_ready__awPa6",text_glow:"order-number-feed_text_glow__335rH"}},217:function(e,t,r){"use strict";r.r(t);var n=r(1),a=r.n(n),c=r(45),s=r.n(c),i=(r(131),r(6)),o=r(116),d=r.n(o),l=r(13),u=r(117),_=r.n(u),j=r(67),m=r.n(j),b=r(118),p=r.n(b),O=r(0);function x(e){var t=e.onClick;return Object(O.jsx)("div",{className:p.a.overlay,onClick:t})}var f=r(5),g=function(e){var t=e.children,r=e.title,a=e.onClose,s=e.isVisible;return Object(n.useEffect)((function(){if(s){var e=function(e){"Escape"===e.key&&a()};return document.addEventListener("keydown",e),function(){document.removeEventListener("keydown",e)}}}),[a,s]),s?Object(c.createPortal)(Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)(x,{onClick:a}),Object(O.jsxs)("div",{className:"".concat(m.a.modal," pr-10 pl-10 pt-10"),children:[Object(O.jsxs)("div",{className:m.a.header,children:[Object(O.jsx)("h2",{className:"text text_type_main-large",children:r}),Object(O.jsx)("button",{className:m.a.close,onClick:a,children:Object(O.jsx)(f.CloseIcon,{type:"primary"})})]}),t]})]}),document.querySelector("#modals")):null},h=r(23),v=r(15),y=r(2),N=r(52),k=function(){return Object(N.b)()},I=N.c,E=r(230),C=r(90),w=r.n(C);function T(e){var t=e.children,r=e.ingredient,n=e.innerRef,a=e.className,c=e.onClick,s=Object(l.h)();return Object(O.jsx)(i.b,{to:{pathname:"/ingredients/".concat(r._id),state:{background:s}},innerRef:n,className:a,onClick:c,children:t},r._id)}var S=Object(n.forwardRef)((function(e,t){var r=e.ingredient,a=e.onIngredientClick,c=e.count,s=Object(n.useCallback)((function(){a(r)}),[a,r]);return Object(O.jsx)(T,{ingredient:r,className:w.a.ingredient_card,innerRef:t,onClick:s,children:Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)(f.Counter,{count:c,size:"small"}),Object(O.jsx)("img",{src:r.image,alt:r.name}),Object(O.jsxs)("div",{className:"".concat(w.a.price," mt-1 mb-1"),children:[Object(O.jsx)("span",{className:"text text_type_main-default mr-2",children:r.price})," ",Object(O.jsx)(f.CurrencyIcon,{type:"primary"})]}),Object(O.jsx)("p",{children:r.name})]})})}));var R=function(e){var t=e.ingredient,r=e.onIngredientClick,n=e.count,a=Object(E.a)({type:"ingredient",item:{ingredient:t}}),c=Object(h.a)(a,2)[1];return Object(O.jsx)(S,{ingredient:t,onIngredientClick:r,count:n,ref:c})},D=r(68),F=r.n(D),L=Object(n.forwardRef)((function(e,t){var r=e.title,n=e.ingredients,a=e.type,c=e.onIngredientClick,s=e.counts;return Object(O.jsxs)("section",{ref:t,className:"".concat(F.a.ingredients_list," pt-10"),children:[Object(O.jsx)("h2",{className:"".concat(F.a.ingredients_list_title," mb-6 text text_type_main-medium"),children:r}),Object(O.jsx)("div",{className:"".concat(F.a.cards_box," pl-4 pr-4"),children:n.filter((function(e){return e.type===a})).map((function(e){return Object(O.jsx)(R,{ingredient:e,onIngredientClick:c,count:s[e._id]},e._id)}))})]})})),P=r(53),U=r.n(P);var B=function(e){var t=e.handleIngredientDetailsOpen,r=I((function(e){var t=e.burgerConstructor;return{selectedIngredients:t.selectedIngredients,selectedBun:t.selectedBun}})),a=r.selectedIngredients,c=r.selectedBun,s=I((function(e){return{ingredients:e.ingredients.ingredients}})).ingredients,i=Object(n.useMemo)((function(){return s.reduce((function(e,t){return"bun"===t.type?Object(y.a)(Object(y.a)({},e),{},Object(v.a)({},t._id,c&&t._id===c._id?1:0)):Object(y.a)(Object(y.a)({},e),{},Object(v.a)({},t._id,a.filter((function(e){return e._id===t._id})).length))}),{})}),[s,a,c]),o=Object(n.useState)("bun"),d=Object(h.a)(o,2),l=d[0],u=d[1],_=Object(n.useRef)(null),j=Object(n.useRef)(null),m=Object(n.useRef)(null),b=Object(n.useCallback)((function(){u("bun")}),[u]),p=Object(n.useCallback)((function(){u("sauce")}),[u]),x=Object(n.useCallback)((function(){u("main")}),[u]),g=Object(n.useCallback)((function(e){if(null!=j.current&&null!=m.current){var t=e.target.scrollTop,r=j.current.offsetTop,n=m.current.offsetTop;t+200<=r?b():t+200<=n?p():x()}}),[b,x,p]);return Object(O.jsxs)("section",{className:"".concat(U.a.ingredients_section," pt-10 mr-10"),children:[Object(O.jsx)("h1",{className:"text text_type_main-large",children:"\u0421\u043e\u0431\u0435\u0440\u0438\u0442\u0435 \u0431\u0443\u0440\u0433\u0435\u0440"}),Object(O.jsxs)("div",{className:"".concat(U.a.ingredients_tabs," pt-5"),children:[Object(O.jsx)(f.Tab,{value:"bun",active:"bun"===l,onClick:b,children:"\u0411\u0443\u043b\u043a\u0438"}),Object(O.jsx)(f.Tab,{value:"sauce",active:"sauce"===l,onClick:p,children:"\u0421\u043e\u0443\u0441\u044b"}),Object(O.jsx)(f.Tab,{value:"main",active:"main"===l,onClick:x,children:"\u041d\u0430\u0447\u0438\u043d\u043a\u0438"})]}),Object(O.jsxs)("div",{className:"".concat(U.a.scrollbox," ").concat(U.a.scrollbar),onScroll:g,children:[Object(O.jsx)(L,{ref:_,title:"\u0411\u0443\u043b\u043a\u0438",type:"bun",ingredients:s,counts:i,onIngredientClick:t},"bun"),Object(O.jsx)(L,{ref:j,title:"\u0421\u043e\u0443\u0441\u044b",type:"sauce",ingredients:s,counts:i,onIngredientClick:t},"sauce"),Object(O.jsx)(L,{ref:m,title:"\u041d\u0430\u0447\u0438\u043d\u043a\u0438",type:"main",ingredients:s,counts:i,onIngredientClick:t},"main")]})]})},M=r(231),A=r(41),G=r.n(A),z=r(69),W=r.n(z),J=Object(n.forwardRef)((function(e,t){var r=e.ingredient,a=e.index,c=e.handleDelete,s=Object(n.useCallback)((function(){return c(a)}),[c,a]);return Object(O.jsxs)("div",{className:"".concat(W.a.constructor_item," mb-4 pl-8"),ref:t,children:[Object(O.jsx)("div",{className:W.a.ingredient_button,children:Object(O.jsx)("button",{className:W.a.drag_button,children:Object(O.jsx)(f.DragIcon,{type:"primary"})})}),Object(O.jsx)(f.ConstructorElement,{text:r.name,price:r.price,thumbnail:r.image,handleClose:s})]})})),q="DELETE_IGREDIENT",V="DROP_INGREDIENT",H="GET_ORDER_NUMBER_SUCCESS",Y="REORDER_CONSTRUCTOR_ITEM";var X=function(e){var t=e.ingredient,r=e.index,a=e.handleDelete,c=Object(n.useRef)(null),s=k(),i=Object(E.a)({type:"constructor-item",item:{dragIndex:r}}),o=Object(h.a)(i,2)[1],d=Object(M.a)({accept:"constructor-item",drop:function(e){var t=e.dragIndex;s({type:Y,payload:{itemIndex:r,dragIndex:t}})}}),l=Object(h.a)(d,2)[1];return Object(n.useEffect)((function(){o(l(c))}),[o,l]),Object(O.jsx)(J,{ingredient:t,index:r,handleDelete:a,ref:c})},Z=Object(n.forwardRef)((function(e,t){var r=e.onSubmit,a=e.ingredients,c=k(),s=I((function(e){return e.burgerConstructor.selectedIngredients})),i=I((function(e){return e.burgerConstructor.selectedBun})),o=Object(n.useMemo)((function(){return s.reduce((function(e,t){return e+t.price}),i?i.price:0)}),[s,i]),d=Object(n.useCallback)((function(){i&&r(s.concat(i))}),[r,s,i]),l=Object(n.useCallback)((function(e){c({type:q,payload:{deleteIndex:e}})}),[c]);return 0===a.length?null:Object(O.jsxs)("section",{className:"".concat(G.a.constructor_section," pt-25"),ref:t,children:[Object(O.jsxs)("div",{className:G.a.constructor_list,children:[i&&Object(O.jsx)("div",{className:"pl-9 pr-4",children:Object(O.jsx)(f.ConstructorElement,{type:"top",isLocked:!0,text:"".concat(i.name," (\u0432\u0435\u0440\u0445)"),price:i.price,thumbnail:i.image})}),Object(O.jsx)("div",{className:"".concat(G.a.constructor_items," ").concat(G.a.scrollbar,"  mt-4 mb-4 pl-4 pr-4"),children:s.map((function(e,t){return Object(O.jsx)(X,{ingredient:e,index:t,handleDelete:l},e.uid)}))}),i?Object(O.jsx)("div",{className:"pl-9 pr-4",children:Object(O.jsx)(f.ConstructorElement,{type:"bottom",isLocked:!0,text:"".concat(i.name," (\u043d\u0438\u0437)"),price:i.price,thumbnail:i.image})}):null]}),Object(O.jsxs)("div",{className:"".concat(G.a.order," pt-10"),children:[Object(O.jsxs)("div",{className:"".concat(G.a.order_price," mr-10"),children:[Object(O.jsx)("span",{className:"text text_type_digits-medium mr-2",children:o}),Object(O.jsx)(f.CurrencyIcon,{type:"primary"})]}),Object(O.jsx)(f.Button,{type:"primary",size:"large",onClick:d,children:"\u041e\u0444\u043e\u0440\u043c\u0438\u0442\u044c \u0437\u0430\u043a\u0430\u0437"})]})]})})),K=r(233);var Q=function(e){var t=e.onSubmit,r=k(),n=Object(M.a)({accept:"ingredient",drop:function(e){var t=e.ingredient;r({type:V,payload:{ingredient:Object(y.a)(Object(y.a)({},t),{},{uid:Object(K.a)()})}})}}),a=Object(h.a)(n,2)[1],c=I((function(e){return{ingredients:e.ingredients.ingredients}})).ingredients;return Object(O.jsx)(Z,{onSubmit:t,ingredients:c,ref:a})},$="https://norma.nomoreparties.space/api",ee=function(e){return e&&e.ok?e.json():e.json().then((function(t){return Promise.reject({message:"\u041e\u0448\u0438\u0431\u043a\u0430 ".concat(e.status),data:t})}))};function te(e){var t=e.email,r=e.password,n=e.name;return fetch("".concat($,"/auth/register"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t,password:r,name:n})}).then((function(e){return ee(e)}))}function re(e){var t=e.email,r=e.password;return fetch("".concat($,"/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t,password:r})}).then((function(e){return ee(e)}))}function ne(e){return fetch("".concat($,"/auth/logout"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:e})}).then((function(e){return ee(e)}))}function ae(e){return fetch("".concat($,"/auth/token"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:e})}).then((function(e){return ee(e)}))}function ce(e){return fetch("".concat($,"/auth/user"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}}).then((function(e){return ee(e)}))}function se(e,t){var r=t.name,n=t.email,a=t.password;return fetch("".concat($,"/auth/user"),{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify({name:r,email:n,password:a})}).then((function(e){return ee(e)}))}var ie="DELETE_SELECTED_INGREDIENT_DATA",oe="GET_INGREDIENTS_REQUEST",de="GET_INGREDIENTS_SUCCESS",le="GET_INGREDIENTS_FAILED",ue="SELECT_INGREDIENT",_e=function(){return function(e){e({type:oe}),fetch("".concat($,"/ingredients")).then((function(e){return ee(e)})).then((function(t){t&&t.success?e({type:de,payload:{ingredients:t.data}}):e({type:le})})).catch((function(e){return console.log(e)}))}};function je(e){var t=document.cookie.match(new RegExp("(?:^|; )"+e.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return t?decodeURIComponent(t[1]):void 0}function me(e,t,r){var n=(r=r||{}).expires;if("number"==typeof n&&n){var a=new Date;a.setTime(a.getTime()+1e3*n),n=r.expires=a}if(n&&n instanceof Date&&n.toUTCString&&(r.expires=n.toUTCString()),null!=t){var c=e+"="+(t=encodeURIComponent(t));for(var s in r){c+="; "+s;var i=r[s];!0!==i&&(c+="="+i)}document.cookie=c}}var be="DELETE_ORDER_DATA",pe="GET_ORDER_NUMBER_REQUEST",Oe="GET_ORDER_NUMBER_FAILED",xe=function(e){return function(t){var r=je("authToken");r&&(t({type:pe}),function(e,t){return fetch("".concat($,"/orders"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify({ingredients:t})}).then((function(e){return ee(e)}))}(r,e).then((function(e){e&&e.success?t({type:H,payload:{order:e.order}}):t({type:Oe})})).catch((function(e){return console.log(e)})))}},fe=r(70),ge=r.n(fe),he=r.p+"static/media/check.2022ce2b.svg";function ve(e){var t=e.order;return t?Object(O.jsxs)("div",{className:"".concat(ge.a.details," pb-30"),children:[Object(O.jsx)("p",{className:"".concat(ge.a.digits," text text_type_digits-large mb-8"),children:t.number}),Object(O.jsx)("p",{className:"text text_type_main-medium",children:"\u0438\u0434\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0440 \u0437\u0430\u043a\u0430\u0437\u0430"}),Object(O.jsx)("img",{className:"".concat(ge.a.checkmark," mt-15 mb-15"),src:he,alt:"order-details"}),Object(O.jsx)("p",{className:"text text_type_main-default mb-2",children:"\u0412\u0430\u0448 \u0437\u0430\u043a\u0430\u0437 \u043d\u0430\u0447\u0430\u043b\u0438 \u0433\u043e\u0442\u043e\u0432\u0438\u0442\u044c"}),Object(O.jsx)("p",{className:"text text_type_main-default text_color_inactive",children:"\u0414\u043e\u0436\u0434\u0438\u0442\u0435\u0441\u044c \u0433\u043e\u0442\u043e\u0432\u043d\u043e\u0441\u0442\u0438 \u043d\u0430 \u043e\u0440\u0431\u0438\u0442\u0430\u043b\u044c\u043d\u043e\u0439 \u0441\u0442\u0430\u043d\u0446\u0438\u0438"})]}):null}var ye=function(){var e=k(),t=Object(l.g)(),r=I((function(e){var t=e.ingredients;return{ingredients:t.ingredients,selectedIngredient:t.selectedIngredient,order:e.order.order,loggedIn:e.user.loggedIn}})),a=r.order,c=r.loggedIn,s=Object(n.useCallback)((function(t){e({type:ue,payload:{ingredient:t}})}),[e]),i=Object(n.useCallback)((function(r){c?e(xe(r.map((function(e){return e._id})))):t.push("/login")}),[e,t,c]),o=Object(n.useCallback)((function(){e({type:be})}),[e]);return Object(O.jsxs)("main",{className:"".concat(_.a.main," pb-10"),children:[Object(O.jsx)(B,{handleIngredientDetailsOpen:s}),Object(O.jsx)(Q,{onSubmit:i}),Object(O.jsx)(g,{isVisible:!!a,onClose:o,children:a?Object(O.jsx)(ve,{order:a}):null})]})},Ne=function(){return Object(O.jsx)(ye,{})},ke=r(26),Ie=r.n(ke),Ee=r(42),Ce="USER_REGISTER",we="USER_LOGIN",Te="USER_SET_DATA",Se="USER_LOGOUT",Re="GET_USER_INFO",De="SET_USER_INFO",Fe=function(e){return function(){var t=Object(Ee.a)(Ie.a.mark((function t(r){var n,a;return Ie.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,null!=(n=localStorage.getItem("refreshToken"))){t.next=6;break}return r({type:Se}),e.push("/login"),t.abrupt("return");case 6:return t.next=8,ne(n);case 8:a=t.sent,console.log("logoutUser",a),a.success&&(localStorage.removeItem("refreshToken"),r({type:Se}),e.push("/login")),t.next=16;break;case 13:t.prev=13,t.t0=t.catch(0),console.error(t.t0);case 16:case"end":return t.stop()}}),t,null,[[0,13]])})));return function(e){return t.apply(this,arguments)}}()},Le=function e(t){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return function(){var n=Object(Ee.a)(Ie.a.mark((function n(a){var c,s;return Ie.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,null!=(c=je("authToken"))||!r){n.next=8;break}return n.next=5,a(Ue());case 5:return n.next=7,a(e(t,!1));case 7:case 11:case 34:case 39:return n.abrupt("return");case 8:if(null!=c){n.next=12;break}return n.next=11,a(Fe(t));case 12:return n.next=14,ce(c);case 14:s=n.sent,console.log("getUserInfoApi",s),a({type:Re,payload:{name:s.user.name,email:s.user.email}}),n.next=40;break;case 19:if(n.prev=19,n.t0=n.catch(0),console.error(n.t0),"jwt expired"!==n.t0.data.message||!r){n.next=37;break}return n.prev=23,n.next=26,a(Ue());case 26:return n.next=28,a(e(t,!1));case 28:n.next=35;break;case 30:return n.prev=30,n.t1=n.catch(23),n.next=34,a(Fe(t));case 35:n.next=40;break;case 37:return n.next=39,a(Fe(t));case 40:case"end":return n.stop()}}),n,null,[[0,19],[23,30]])})));return function(e){return n.apply(this,arguments)}}()},Pe=function e(t,r,n,a){var c=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];return function(){var s=Object(Ee.a)(Ie.a.mark((function s(i){var o,d;return Ie.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:if(s.prev=0,null!=(o=je("authToken"))||!c){s.next=8;break}return s.next=5,i(Ue());case 5:return s.next=7,i(e(t,r,n,a,!1));case 7:return s.abrupt("return");case 8:if(null!=o){s.next=12;break}return s.next=11,i(Fe(a));case 11:return s.abrupt("return");case 12:return s.next=14,se(o,{name:t,email:r,password:n});case 14:d=s.sent,i({type:De,payload:{name:d.user.name,email:d.user.email,password:d.user.password}}),s.next=32;break;case 18:if(s.prev=18,s.t0=s.catch(0),console.error(s.t0),"jwt expired"!==s.t0.data.message||!c){s.next=32;break}return s.prev=22,s.next=25,i(Ue());case 25:return s.next=27,i(e(t,r,n,a,!1));case 27:s.next=32;break;case 29:s.prev=29,s.t1=s.catch(22),console.error("err");case 32:case"end":return s.stop()}}),s,null,[[0,18],[22,29]])})));return function(e){return s.apply(this,arguments)}}()},Ue=function(){return Object(Ee.a)(Ie.a.mark((function e(){var t,r,n;return Ie.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,null!=(t=localStorage.getItem("refreshToken"))){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,ae(t);case 6:r=e.sent,(n=r.accessToken.split("Bearer ")[1])&&r.refreshToken&&(me("authToken",n),localStorage.setItem("refreshToken",r.refreshToken)),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),console.error(e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})))},Be=r(11),Me=r.n(Be),Ae=function(){var e=k(),t=Object(l.g)(),r=I((function(e){return{email:e.user.email,password:e.user.password,name:e.user.name,loggedIn:e.user.loggedIn}})),a=r.email,c=r.password,s=r.name,o=Object(n.useCallback)((function(t){var r=t.target,n=r.name,a=r.value;e({type:Ce,payload:Object(v.a)({},n,a)})}),[e]),d=Object(n.useCallback)((function(r){r.preventDefault(),e(function(e,t,r,n){return Object(Ee.a)(Ie.a.mark((function a(){var c;return Ie.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,te({email:e,password:t,name:r});case 3:c=a.sent,console.log("registerUser",c),n.push("/login"),a.next=11;break;case 8:a.prev=8,a.t0=a.catch(0),console.error(a.t0);case 11:case"end":return a.stop()}}),a,null,[[0,8]])})))}(a,c,s,t))}),[e,a,s,c,t]);return Object(O.jsx)("div",{className:Me.a.main,children:Object(O.jsxs)("div",{className:"".concat(Me.a.form__block," pt-20"),children:[Object(O.jsx)("h1",{className:"text text_type_main-medium mb-6",children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"}),Object(O.jsxs)("form",{className:Me.a.form,onSubmit:d,children:[Object(O.jsx)("div",{className:"mb-6",children:Object(O.jsx)(f.Input,{type:"text",placeholder:"\u0418\u043c\u044f",onChange:function(e){return o(e)},value:s,name:"name",error:!1,errorText:"\u041e\u0448\u0438\u0431\u043a\u0430",size:"default"})}),Object(O.jsx)("div",{className:"mb-6",children:Object(O.jsx)(f.Input,{type:"email",placeholder:"E-mail",onChange:function(e){return o(e)},value:a,name:"email",error:!1,errorText:"\u041e\u0448\u0438\u0431\u043a\u0430",size:"default"})}),Object(O.jsx)("div",{className:"mb-6",children:Object(O.jsx)(f.PasswordInput,{onChange:function(e){return o(e)},value:c,name:"password"})}),Object(O.jsx)(f.Button,{type:"primary",size:"medium",children:"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f"})]}),Object(O.jsx)("div",{children:Object(O.jsxs)("p",{className:"text text_type_main-default text_color_inactive mt-20",children:["\u0423\u0436\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u044b?"," ",Object(O.jsx)(i.b,{to:"/login",className:Me.a.login,children:"\u0412\u043e\u0439\u0442\u0438"})]})})]})})},Ge=function(){var e=k(),t=Object(l.g)(),r=I((function(e){return{email:e.user.email,password:e.user.password,loggedIn:e.user.loggedIn}})),a=r.email,c=r.password,s=Object(n.useCallback)((function(t){var r=t.target,n=r.name,a=r.value;e({type:Te,payload:Object(v.a)({},n,a)})}),[e]),o=Object(n.useCallback)((function(r){r.preventDefault(),e(function(e,t,r){return function(){var n=Object(Ee.a)(Ie.a.mark((function n(a){var c,s;return Ie.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,re({email:e,password:t});case 3:if(null!=(c=n.sent).accessToken){n.next=6;break}return n.abrupt("return");case 6:(s=c.accessToken.split("Bearer ")[1])&&c.refreshToken&&(me("authToken",s),localStorage.setItem("refreshToken",c.refreshToken)),c.success&&(a({type:we}),r.push("/")),n.next=14;break;case 11:n.prev=11,n.t0=n.catch(0),console.error(n.t0);case 14:case"end":return n.stop()}}),n,null,[[0,11]])})));return function(e){return n.apply(this,arguments)}}()}(a,c,t))}),[e,a,c,t]);return Object(O.jsx)("div",{className:Me.a.main,children:Object(O.jsxs)("div",{className:"".concat(Me.a.form__block," pt-20"),children:[Object(O.jsx)("h1",{className:"text text_type_main-medium mb-6",children:"\u0412\u0445\u043e\u0434"}),Object(O.jsxs)("form",{className:Me.a.form,onSubmit:o,children:[Object(O.jsx)("div",{className:"mb-6",children:Object(O.jsx)(f.Input,{type:"email",placeholder:"E-mail",onChange:function(e){return s(e)},value:a,name:"email",error:!1,errorText:"\u041e\u0448\u0438\u0431\u043a\u0430",size:"default"})}),Object(O.jsx)("div",{className:"mb-6",children:Object(O.jsx)(f.PasswordInput,{onChange:function(e){return s(e)},value:c,name:"password"})}),Object(O.jsx)(f.Button,{type:"primary",size:"medium",children:"\u0412\u043e\u0439\u0442\u0438"})]}),Object(O.jsx)("div",{className:Me.a.register,children:Object(O.jsxs)("p",{className:"text text_type_main-default text_color_inactive mt-20",children:["\u0412\u044b \u2014 \u043d\u043e\u0432\u044b\u0439 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c?"," ",Object(O.jsx)(i.b,{to:"/register",className:Me.a.link,children:"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f"})]})}),Object(O.jsx)("div",{className:Me.a.forgot_password,children:Object(O.jsxs)("p",{className:"text text_type_main-default text_color_inactive mt-4",children:["\u0417\u0430\u0431\u044b\u043b\u0438 \u043f\u0430\u0440\u043e\u043b\u044c?"," ",Object(O.jsx)(i.b,{to:"/forgot-password",className:Me.a.link,children:"\u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u043f\u0430\u0440\u043e\u043b\u044c"})]})})]})})},ze="FORGOT_PASSWORD_SET_EMAIL",We="RESET_PASSWORD",Je=function(e,t,r){return function(n){(function(e,t){return fetch("".concat($,"/password-reset/reset"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:e,token:t})}).then((function(e){return ee(e)}))})(e,t).then((function(e){console.log(e),e.success&&(r.push("/"),n({type:We}))})).catch((function(e){return console.log(e)}))}},qe=function(e,t){return function(){(function(e){return fetch("".concat($,"/password-reset"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e})}).then((function(e){return ee(e)}))})(e).then((function(e){console.log("forgotPasswordApi",e),e.success&&(t.push("/reset-password"),console.log("redir",e))})).catch((function(e){return console.log(e)}))}},Ve=function(){var e=k(),t=Object(l.g)(),r=I((function(e){return{email:e.resetPassword.email}})).email,a=Object(n.useCallback)((function(t){var r=t.target,n=r.name,a=r.value;e({type:ze,payload:Object(v.a)({},n,a)})}),[e]),c=Object(n.useCallback)((function(n){n.preventDefault(),e(qe(r,t))}),[e,r,t]);return Object(O.jsx)("div",{className:Me.a.main,children:Object(O.jsxs)("div",{className:"".concat(Me.a.form__block," pt-20"),children:[Object(O.jsx)("h1",{className:"text text_type_main-medium mb-6",children:"\u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u043f\u0430\u0440\u043e\u043b\u044f"}),Object(O.jsxs)("form",{className:Me.a.form,onSubmit:c,children:[Object(O.jsx)("div",{className:"mb-6",children:Object(O.jsx)(f.Input,{type:"email",placeholder:"\u0423\u043a\u0430\u0436\u0438\u0442\u0435 e-mail",onChange:function(e){a(e)},value:r,name:"email",error:!1,errorText:"\u041e\u0448\u0438\u0431\u043a\u0430",size:"default"})}),Object(O.jsx)(f.Button,{type:"primary",size:"medium",children:"\u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c"})]}),Object(O.jsx)("div",{children:Object(O.jsxs)("p",{className:"text text_type_main-default text_color_inactive mt-20",children:["\u0412\u0441\u043f\u043e\u043c\u043d\u0438\u043b\u0438 \u043f\u0430\u0440\u043e\u043b\u044c?"," ",Object(O.jsx)(i.b,{to:"/login",className:Me.a.link,children:"\u0412\u043e\u0439\u0442\u0438"})]})})]})})},He=function(){var e=Object(n.useState)({password:"",resetToken:""}),t=Object(h.a)(e,2),r=t[0],a=t[1],c=I((function(e){return{email:e.resetPassword.email}})).email,s=k(),o=Object(l.g)(),d=Object(n.useCallback)((function(e){var t=e.target,r=t.name,n=t.value;a(Object(v.a)({},r,n))}),[]),u=Object(n.useCallback)((function(e){e.preventDefault(),s(Je(r.password,r.resetToken,o))}),[s,o,r]);return Object(n.useEffect)((function(){c||o.push("/forgot-password")}),[]),Object(O.jsx)("div",{className:Me.a.main,children:Object(O.jsxs)("div",{className:"".concat(Me.a.form__block," pt-20"),children:[Object(O.jsx)("h1",{className:"text text_type_main-medium mb-6",children:"\u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u043f\u0430\u0440\u043e\u043b\u044f"}),Object(O.jsxs)("form",{className:Me.a.form,onSubmit:u,children:[Object(O.jsx)("div",{className:"mb-6",children:Object(O.jsx)(f.PasswordInput,{onChange:function(e){return d(e)},value:r.password,name:"password"})}),Object(O.jsx)("div",{className:"mb-6",children:Object(O.jsx)(f.Input,{type:"text",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043a\u043e\u0434 \u0438\u0437 \u043f\u0438\u0441\u044c\u043c\u0430",onChange:function(e){return d(e)},value:r.resetToken,name:"code",error:!1,errorText:"\u041e\u0448\u0438\u0431\u043a\u0430",size:"default"})}),Object(O.jsx)(f.Button,{type:"primary",size:"medium",children:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"})]}),Object(O.jsxs)("p",{className:"text text_type_main-default text_color_inactive mt-20",children:["\u0412\u0441\u043f\u043e\u043c\u043d\u0438\u043b\u0438 \u043f\u0430\u0440\u043e\u043b\u044c?"," ",Object(O.jsx)(i.b,{to:"/login",className:Me.a.link,children:"\u0412\u043e\u0439\u0442\u0438"})]})]})})};function Ye(){var e=Object(l.g)(),t=k();Object(n.useEffect)((function(){t(Le(e))}),[t,e])}var Xe=r(36),Ze=r.n(Xe),Ke=function(){Ye();var e=I((function(e){return{name:e.user.name,email:e.user.email,password:e.user.password}})),t=e.name,r=e.email,a=e.password,c=Object(n.useState)({username:t,useremail:r,userpassword:a}),s=Object(h.a)(c,2),o=s[0],d=s[1],u=k(),_=Object(l.g)();Object(n.useEffect)((function(){d((function(e){return Object(y.a)(Object(y.a)({},e),{},{username:t||"",useremail:r||""})}))}),[r,t]);var j=Object(n.useCallback)((function(e){d((function(t){return Object(y.a)(Object(y.a)({},t),{},Object(v.a)({},e.target.name,e.target.value))}))}),[]),m=Object(n.useCallback)((function(e){e.preventDefault(),u(Pe(o.username,o.useremail,o.userpassword,_))}),[u,o,_]),b=o.username!==t||o.useremail!==r||o.userpassword!==a;return Object(O.jsxs)("div",{className:"".concat(Ze.a.main," pt-20"),children:[Object(O.jsxs)("nav",{className:"".concat(Ze.a.nav," mr-15"),children:[Object(O.jsx)(i.c,{to:"/profile",activeClassName:Ze.a.active_link,className:"".concat(Ze.a.navlink," text text_type_main-medium text_color_inactive mb-6"),children:"\u041f\u0440\u043e\u0444\u0438\u043b\u044c"}),Object(O.jsx)(i.c,{to:"/profile/orders",className:"".concat(Ze.a.navlink," text text_type_main-medium text_color_inactive mb-6"),children:"\u0418\u0441\u0442\u043e\u0440\u0438\u044f \u0437\u0430\u043a\u0430\u0437\u043e\u0432"}),Object(O.jsx)("button",{className:"".concat(Ze.a.logout," text text_type_main-medium text_color_inactive mb-6"),onClick:function(){u(Fe(_))},children:"\u0412\u044b\u0445\u043e\u0434"}),Object(O.jsx)("p",{className:"".concat(Ze.a.nav_text," text text_type_main-default text_color_inactive"),children:"\u0412 \u044d\u0442\u043e\u043c \u0440\u0430\u0437\u0434\u0435\u043b\u0435 \u0432\u044b \u043c\u043e\u0436\u0435\u0442\u0435 \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0441\u0432\u043e\u0438 \u043f\u0435\u0440\u0441\u043e\u043d\u0430\u043b\u044c\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435"})]}),Object(O.jsxs)("form",{className:Ze.a.form,onSubmit:m,children:[Object(O.jsx)("div",{className:"mb-6",children:Object(O.jsx)(f.Input,{type:"text",placeholder:"\u0418\u043c\u044f",onChange:function(e){j(e)},icon:"EditIcon",value:o.username,name:"username",error:!1,errorText:"\u041e\u0448\u0438\u0431\u043a\u0430",size:"default"})}),Object(O.jsx)("div",{className:"mb-6",children:Object(O.jsx)(f.Input,{type:"text",placeholder:"\u041b\u043e\u0433\u0438\u043d",onChange:function(e){j(e)},icon:"EditIcon",value:o.useremail,name:"useremail",error:!1,errorText:"\u041e\u0448\u0438\u0431\u043a\u0430",size:"default"})}),Object(O.jsx)("div",{children:Object(O.jsx)(f.Input,{type:"password",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",onChange:function(e){j(e)},icon:"EditIcon",value:o.userpassword,name:"userpassword",error:!1,errorText:"\u041e\u0448\u0438\u0431\u043a\u0430",size:"default"})}),b&&Object(O.jsxs)("div",{className:"mt-6",children:[Object(O.jsx)(f.Button,{type:"primary",size:"small",children:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"}),Object(O.jsx)(f.Button,{type:"secondary",size:"small",onClick:function(){d({username:t,useremail:r,userpassword:a})},children:"\u041e\u0442\u043c\u0435\u043d\u0430"})]})]})]})};var Qe=function(e){var t=I((function(e){return{loggedIn:e.user.loggedIn}})).loggedIn,r=Object(l.h)();return Object(O.jsx)(l.b,Object(y.a)(Object(y.a)({},e),{},{children:t?e.children:Object(O.jsx)(l.a,{to:{pathname:"/login",state:{from:r}}})}))},$e=r(54),et=r.n($e);function tt(e){var t=e.ingredient||{},r=t.image_large,n=t.name,a=t.calories,c=t.proteins,s=t.fat,i=t.carbohydrates;return Object(O.jsx)("div",{className:"".concat(et.a.details," pt-10 pb-15"),children:Object(O.jsxs)("div",{className:et.a.content,children:[Object(O.jsx)("img",{className:et.a.image,src:r,alt:n}),Object(O.jsx)("p",{className:"text text_type_main-medium mt-4 mb-8",children:n}),Object(O.jsxs)("ul",{className:et.a.list,children:[Object(O.jsxs)("li",{children:[Object(O.jsx)("p",{className:"text text_type_main-default text_color_inactive mb-2",children:"\u041a\u0430\u043b\u043e\u0440\u0438\u0438,\u043a\u043a\u0430\u043b"}),Object(O.jsx)("span",{className:"text text_type_digits-default text_color_inactive",children:a})]}),Object(O.jsxs)("li",{children:[Object(O.jsx)("p",{className:"text text_type_main-default text_color_inactive mb-2",children:"\u0411\u0435\u043b\u043a\u0438, \u0433"}),Object(O.jsx)("span",{className:"text text_type_digits-default text_color_inactive",children:c})]}),Object(O.jsxs)("li",{children:[Object(O.jsx)("p",{className:"text text_type_main-default text_color_inactive mb-2",children:"\u0416\u0438\u0440\u044b, \u0433"}),Object(O.jsx)("span",{className:"text text_type_digits-default text_color_inactive",children:s})]}),Object(O.jsxs)("li",{children:[Object(O.jsx)("p",{className:"text text_type_main-default text_color_inactive mb-2",children:"\u0423\u0433\u043b\u0435\u0432\u043e\u0434\u044b, \u0433"}),Object(O.jsx)("span",{className:"text text_type_digits-default text_color_inactive",children:i})]})]})]})})}function rt(){var e=Object(l.i)().id,t=I((function(e){return{ingredients:e.ingredients.ingredients}})).ingredients.find((function(t){return t._id===e}));return t?Object(O.jsx)(tt,{ingredient:t}):null}function nt(){var e=Object(l.i)().id,t=Object(l.g)(),r=k(),a=I((function(e){var t=e.ingredients;return{ingredients:t.ingredients,selectedIngredient:t.selectedIngredient}})),c=a.selectedIngredient,s=a.ingredients,i=Object(n.useMemo)((function(){return c||s.find((function(t){return t._id===e}))}),[e,c,s]),o=Object(n.useCallback)((function(){r({type:ie}),t.goBack()}),[r,t]);return Object(O.jsx)(g,{isVisible:!!i,onClose:o,title:"\u0414\u0435\u0442\u0430\u043b\u0438 \u0438\u043d\u0433\u0440\u0435\u0434\u0438\u0435\u043d\u0442\u0430",children:i&&Object(O.jsx)(tt,{ingredient:i})})}var at=function(e){var t=I((function(e){return{loggedIn:e.user.loggedIn}})).loggedIn;return Object(O.jsx)(l.b,Object(y.a)(Object(y.a)({},e),{},{children:t?Object(O.jsx)(l.a,{to:"/login"}):e.children}))},ct=r(34),st=r.n(ct);var it=function(){return Object(O.jsxs)("header",{className:"".concat(st.a.header," p-4"),children:[Object(O.jsxs)("nav",{className:st.a.nav,children:[Object(O.jsxs)(i.c,{exact:!0,to:"/",className:"".concat(st.a.navLink," pr-5 pt-4 pb-4 mr-2"),activeClassName:st.a.active_link,children:[Object(O.jsx)(f.BurgerIcon,{type:"primary"}),Object(O.jsx)("span",{className:"text text_type_main-default ml-2",children:"\u041a\u043e\u043d\u0441\u0442\u0440\u0443\u043a\u0442\u043e\u0440"})]}),Object(O.jsxs)(i.c,{to:"/feed",className:"".concat(st.a.navLink," pl-5 pr-5 pt-4 pb-4"),activeClassName:st.a.active_link,children:[Object(O.jsx)(f.ListIcon,{type:"primary"}),Object(O.jsx)("span",{className:"text text_type_main-default ml-2",children:"\u041b\u0435\u043d\u0442\u0430 \u0437\u0430\u043a\u0430\u0437\u043e\u0432"})]})]}),Object(O.jsx)(f.Logo,{}),Object(O.jsx)("div",{className:st.a.auth,children:Object(O.jsxs)(i.c,{exact:!0,to:"/profile",className:"".concat(st.a.navLink," pl-5 pr-5 pt-4 pb-4"),activeClassName:st.a.active_link,children:[Object(O.jsx)(f.ProfileIcon,{type:"primary"}),Object(O.jsx)("span",{className:"text text_type_main-default ml-2",children:"\u041b\u0438\u0447\u043d\u044b\u0439 \u043a\u0430\u0431\u0438\u043d\u0435\u0442"})]})})]})},ot=r(17),dt=r.n(ot),lt=r(226),ut=r(235),_t=r(234),jt=r(229),mt=r(232);function bt(e){var t=new Date(e);return[Object(lt.a)(t)?"\u0421\u0435\u0433\u043e\u0434\u043d\u044f":Object(ut.a)(t)?"\u0412\u0447\u0435\u0440\u0430":Object(_t.a)(t,{locale:mt.a,addSuffix:!0}),Object(jt.a)(t,"HH:mm 'i-'O")].join(", ")}function pt(e){switch(e){case"created":return"\u0421\u043e\u0437\u0434\u0430\u043d";case"pending":return"\u0413\u043e\u0442\u043e\u0432\u0438\u0442\u0441\u044f";case"done":return"\u0412\u044b\u043f\u043e\u043b\u043d\u0435\u043d";default:return"\u041d\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043d\u044b\u0439 \u0441\u0442\u0430\u0442\u0443\u0441"}}function Ot(e){var t=I((function(t){var r=t.orders.orders;return{ingredients:t.ingredients.ingredients,order:r[e]}})),r=t.order,a=t.ingredients,c=Object(n.useMemo)((function(){return a.filter((function(e){return!!r&&r.ingredients.includes(e._id)}))}),[r,a]),s=Object(n.useMemo)((function(){return{orderIngredientsSlice:c.slice(0,5),orderIngredientsRest:c.slice(5)}}),[c]),i=s.orderIngredientsSlice,o=s.orderIngredientsRest,d=Object(n.useMemo)((function(){return r?r.ingredients.reduce((function(e,t){return e[t]=(e[t]||0)+1,e}),{}):{}}),[r]),l=Object(n.useMemo)((function(){return c.reduce((function(e,t){return e+t.price*d[t._id]}),0)}),[c,d]);return{order:r,orderIngredients:c,orderIngredientCounts:d,orderTotal:l,orderIngredientsSlice:i,orderIngredientsRest:o}}var xt=function(e){var t=Ot(e.orderId),r=t.order,n=t.orderIngredients,a=t.orderIngredientCounts,c=t.orderTotal;return r?Object(O.jsx)("div",{className:"".concat(dt.a.order_details," pb-6 pt-6"),children:Object(O.jsxs)("div",{className:dt.a.order_info,children:[Object(O.jsx)("div",{className:"".concat(dt.a.order_number," mb-10"),children:Object(O.jsxs)("p",{className:"text text_type_digits-default",children:["#",r.number]})}),Object(O.jsxs)("div",{className:"mb-15",children:[Object(O.jsx)("h1",{className:"".concat(dt.a.order_title," text text_type_main-medium mb-3"),children:r.name}),Object(O.jsx)("p",{className:"".concat("done"===r.status?dt.a.order_status_done:dt.a.order_status_in_progress," text text_type_main-default"),children:pt(r.status)})]}),Object(O.jsxs)("div",{className:"".concat(dt.a.order_ingredients," pr-4"),children:[Object(O.jsx)("p",{className:"text text_type_main-medium mb-6",children:"\u0421\u043e\u0441\u0442\u0430\u0432:"}),Object(O.jsx)("ul",{className:dt.a.order_ingredients_list,children:n.map((function(e,t){return Object(O.jsxs)("li",{className:"".concat(dt.a.order_ingredients_listitem," mb-4"),children:[Object(O.jsxs)("div",{className:dt.a.ingredient_details,children:[Object(O.jsx)("img",{src:e.image_mobile,alt:"Img"}),Object(O.jsx)("p",{className:"".concat(dt.a.ingredient_title," text text_type_main-default ml-4"),children:e.name})]}),Object(O.jsxs)("div",{className:dt.a.ingredient_cost,children:[Object(O.jsxs)("p",{className:"text text_type_digits-default mr-2 ml-4",children:[Object(O.jsx)("span",{children:a[e._id]})," x"," ",Object(O.jsx)("span",{children:e.price})]}),Object(O.jsx)(f.CurrencyIcon,{type:"primary"})]})]},"".concat(e._id).concat(t))}))})]}),Object(O.jsxs)("div",{className:dt.a.order_date,children:[Object(O.jsx)("p",{className:"text text_type_main-default text_color_inactive",children:bt(r.createdAt)}),Object(O.jsxs)("div",{className:dt.a.order_sum,children:[Object(O.jsx)("p",{className:"text text_type_digits-default mr-2",children:c}),Object(O.jsx)(f.CurrencyIcon,{type:"primary"})]})]})]})}):null},ft="WS_CONNECTION_INIT",gt="WS_CONNECTION_CLOSE",ht="FEED_WS_CONNECTION_START",vt="FEED_WS_CONNECTION_SUCCESS",yt="FEED_WS_CONNECTION_ERROR",Nt="FEED_WS_GET_MESSAGE",kt="PROFILE_FEED_WS_CONNECTION_START",It="PROFILE_FEED_WS_CONNECTION_SUCCESS",Et="PROFILE_FEED_WS_CONNECTION_ERROR",Ct="PROFILE_FEED_WS_GET_MESSAGE";function wt(){var e=k();Object(n.useEffect)((function(){return e({type:ft,payload:{wsUrl:"wss://norma.nomoreparties.space/orders/all",id:"feed",actions:{start:ht,open:vt,error:yt,message:Nt,close:"FEED_WS_CONNECTION_CLOSED"}}}),function(){e({type:gt,payload:{id:"feed"}})}}),[e])}function Tt(){wt();var e=Object(l.i)().id;return Object(O.jsx)(xt,{orderId:e})}function St(){var e=k();Object(n.useEffect)((function(){var t=je("authToken");if(t)return e({type:ft,payload:{wsUrl:"wss://norma.nomoreparties.space/orders?token=".concat(t),id:"profileFeed",actions:{start:kt,open:It,error:Et,message:Ct,close:"PROFILE_FEED_WS_CONNECTION_CLOSED"}}}),function(){e({type:gt,payload:{id:"profileFeed"}})};console.log("useWsProfileFeed","missing token")}),[e])}function Rt(){St(),Ye();var e=Object(l.i)().id;return Object(O.jsx)(xt,{orderId:e})}var Dt=r(27),Ft=r.n(Dt),Lt=function(e){var t=Ot(e.orderId),r=t.order,n=t.orderTotal,a=t.orderIngredientsSlice,c=t.orderIngredientsRest;return r?Object(O.jsxs)("div",{className:"".concat(Ft.a.order_card," p-6"),children:[Object(O.jsxs)("div",{className:"".concat(Ft.a.order_number," mb-6"),children:[Object(O.jsxs)("p",{className:"text text_type_digits-default",children:["#",r.number]}),Object(O.jsx)("p",{className:"text text_type_main-default text_color_inactive",children:bt(r.createdAt)})]}),Object(O.jsx)("h1",{className:"".concat(Ft.a.order_title," mb-6 text text_type_main-medium"),children:r.name}),Object(O.jsxs)("div",{className:Ft.a.order_ingredients,children:[Object(O.jsxs)("div",{className:Ft.a.order_ingredients_images,children:[a.map((function(e,t){return Object(O.jsx)("div",{className:Ft.a.order_images_border,children:Object(O.jsx)("img",{src:e.image_mobile,alt:"img",className:Ft.a.order_ingredient_image})},"".concat(e._id).concat(t))})),c.length>0?Object(O.jsxs)("div",{className:Ft.a.order_images_border,children:[Object(O.jsx)("img",{src:c[0].image_large,alt:"img",className:Ft.a.order_ingredient_image}),Object(O.jsxs)("div",{className:Ft.a.order_ingredient_count,children:["+",c.length]})]}):null]}),Object(O.jsx)("div",{className:Ft.a.order_price,children:Object(O.jsxs)("p",{className:"text text_type_digits-default",children:[n,Object(O.jsx)("span",{className:"".concat(Ft.a.order_icon," ml-2"),children:Object(O.jsx)(f.CurrencyIcon,{type:"primary"})})]})})]})]}):null},Pt=r(20),Ut=r.n(Pt),Bt=function(e){var t=e.readyNumbers,r=e.inProgressNumbers,n=e.doneToday,a=e.doneTotal;return Object(O.jsxs)("div",{className:Ut.a.order_numbers_feed,children:[Object(O.jsxs)("div",{className:Ut.a.order_numbers,children:[Object(O.jsxs)("div",{className:Ut.a.order_numbers_ready,children:[Object(O.jsx)("p",{className:"text text_type_main-medium mb-6",children:"\u0413\u043e\u0442\u043e\u0432\u044b:"}),Object(O.jsx)("ul",{className:Ut.a.order_numbers_ready_list,children:t.map((function(e){return Object(O.jsx)("li",{className:"".concat(Ut.a.order_numbers_list_item," ").concat(Ut.a.list_item," text text_type_digits-default"),children:e},e)}))})]}),Object(O.jsxs)("div",{className:Ut.a.order_numbers_inprogress,children:[Object(O.jsx)("p",{className:"text text_type_main-medium mb-6",children:"\u0412 \u0440\u0430\u0431\u043e\u0442\u0435:"}),Object(O.jsx)("ul",{className:Ut.a.order_numbers_inprogress_list,children:r.map((function(e){return Object(O.jsx)("li",{className:"".concat(Ut.a.order_numbers_list_item," text text_type_digits-default"),children:e},e)}))})]})]}),Object(O.jsxs)("div",{className:"".concat(Ut.a.orders_done_alltime," mt-15"),children:[Object(O.jsx)("p",{className:"text text_type_main-medium",children:"\u0412\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u043e \u0437\u0430 \u0432\u0441\u0435 \u0432\u0440\u0435\u043c\u044f:"}),Object(O.jsx)("p",{className:"text text_type_digits-large ".concat(Ut.a.text_glow),children:a})]}),Object(O.jsxs)("div",{className:Ut.a.orders_done_today,children:[Object(O.jsx)("p",{className:"text text_type_main-medium",children:"\u0412\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u043e \u0437\u0430 \u0441\u0435\u0433\u043e\u0434\u043d\u044f:"}),Object(O.jsx)("p",{className:"text text_type_digits-large ".concat(Ut.a.text_glow),children:n})]})]})},Mt=r(16),At=r.n(Mt);function Gt(){wt();var e=I((function(e){var t=e.feed;return{orders:t.orders,total:t.total,totalToday:t.totalToday}})),t=e.orders,r=e.total,a=e.totalToday,c=Object(l.h)(),s=Object(n.useMemo)((function(){return t.filter((function(e){return"done"===e.status})).slice(0,6).map((function(e){return e.number}))}),[t]),o=Object(n.useMemo)((function(){return t.filter((function(e){return"done"!==e.status})).slice(0,6).map((function(e){return e.number}))}),[t]);return Object(O.jsxs)("div",{children:[Object(O.jsx)("h1",{children:"\u041b\u0435\u043d\u0442\u0430 \u0437\u0430\u043a\u0430\u0437\u043e\u0432"}),Object(O.jsxs)("div",{className:At.a.feed_page_grid,children:[Object(O.jsx)("div",{className:"".concat(At.a.order_list," ").concat(At.a.scrollbar),children:t.map((function(e){var t=e._id;return Object(O.jsx)(i.b,{to:{pathname:"/feed/".concat(t),state:{background:c}},className:At.a.feed_item_link,children:Object(O.jsx)(Lt,{orderId:t})},t)}))}),Object(O.jsx)(Bt,{doneToday:a||0,doneTotal:r||0,readyNumbers:s,inProgressNumbers:o})]})]})}var zt=function(){return Object(O.jsx)(Gt,{})};function Wt(){St();var e=I((function(e){return e.profileFeed.orders})),t=Object(l.h)(),r=k(),n=Object(l.g)();return Object(O.jsxs)("div",{className:"".concat(At.a.main," pt-20"),children:[Object(O.jsxs)("nav",{className:"".concat(At.a.nav," mr-15"),children:[Object(O.jsx)(i.c,{to:"/profile",className:"".concat(At.a.navlink," text text_type_main-medium text_color_inactive mb-6"),children:"\u041f\u0440\u043e\u0444\u0438\u043b\u044c"}),Object(O.jsx)(i.c,{to:"/profile/orders",className:"".concat(At.a.navlink," text text_type_main-medium text_color_inactive mb-6"),activeClassName:At.a.active_link,children:"\u0418\u0441\u0442\u043e\u0440\u0438\u044f \u0437\u0430\u043a\u0430\u0437\u043e\u0432"}),Object(O.jsx)("button",{className:"".concat(At.a.logout," text text_type_main-medium text_color_inactive mb-6"),onClick:function(){r(Fe(n))},children:"\u0412\u044b\u0445\u043e\u0434"})]}),Object(O.jsx)("div",{className:"".concat(At.a.profile_order_list),children:Object(O.jsx)("div",{className:"".concat(At.a.order_list," ").concat(At.a.scrollbar),children:e.map((function(e){var r=e._id;return Object(O.jsx)(i.b,{to:{pathname:"/profile/orders/".concat(r),state:{background:t}},className:At.a.feed_item_link,children:Object(O.jsx)(Lt,{orderId:r})},r)}))})})]})}function Jt(){return Ye(),Object(O.jsx)(Wt,{})}function qt(){var e=Object(l.g)(),t=Object(l.i)().id,r=Object(n.useCallback)((function(){e.goBack()}),[e]);return Object(O.jsx)(g,{isVisible:!!t,onClose:r,children:Object(O.jsx)(xt,{orderId:t})})}function Vt(){return Ye(),Object(O.jsx)(qt,{})}function Ht(){return Object(O.jsx)(qt,{})}function Yt(){var e=Object(l.h)(),t=e.state&&e.state.background,r=k();return Object(n.useEffect)((function(){r(_e())}),[r]),Object(O.jsxs)("div",{className:d.a.page,children:[Object(O.jsx)(it,{}),Object(O.jsxs)(l.d,{location:t||e,children:[Object(O.jsx)(l.b,{exact:!0,path:"/",children:Object(O.jsx)(Ne,{})}),Object(O.jsx)(at,{path:"/register",children:Object(O.jsx)(Ae,{})}),Object(O.jsx)(at,{path:"/login",children:Object(O.jsx)(Ge,{})}),Object(O.jsx)(at,{path:"/forgot-password",children:Object(O.jsx)(Ve,{})}),Object(O.jsx)(at,{path:"/reset-password",children:Object(O.jsx)(He,{})}),Object(O.jsx)(l.b,{path:"/ingredients/:id",children:Object(O.jsx)(rt,{})}),Object(O.jsx)(l.b,{path:"/feed",exact:!0,children:Object(O.jsx)(zt,{})}),Object(O.jsx)(l.b,{path:"/feed/:id",children:Object(O.jsx)(Tt,{})}),Object(O.jsx)(Qe,{path:"/profile",exact:!0,children:Object(O.jsx)(Ke,{})}),Object(O.jsx)(Qe,{path:"/profile/orders",exact:!0,children:Object(O.jsx)(Jt,{})}),Object(O.jsx)(Qe,{path:"/profile/orders/:id",children:Object(O.jsx)(Rt,{})})]}),t&&Object(O.jsxs)(a.a.Fragment,{children:[Object(O.jsx)(l.b,{path:"/ingredients/:id",children:Object(O.jsx)(nt,{})}),Object(O.jsx)(l.b,{path:"/feed/:id",children:Object(O.jsx)(Ht,{})}),Object(O.jsx)(Qe,{path:"/profile/orders/:id",children:Object(O.jsx)(Vt,{})})]})]})}var Xt,Zt=function(){return Object(O.jsx)(i.a,{children:Object(O.jsx)(Yt,{})})},Kt=function(e){e&&e instanceof Function&&r.e(3).then(r.bind(null,236)).then((function(t){var r=t.getCLS,n=t.getFID,a=t.getFCP,c=t.getLCP,s=t.getTTFB;r(e),n(e),a(e),c(e),s(e)}))},Qt=r(228),$t=r(125),er=r(227).a,tr=r(124),rr=r(33),nr=r(94),ar={selectedIngredients:[],selectedBun:null},cr={ingredients:[],ingredientsRequest:!1,ingredientsFailed:!1,selectedIngredient:null},sr={order:null,orderNumberRequest:!1,orderNumberFailed:!1},ir={email:""},or={email:"",password:"",name:"",loggedIn:!!localStorage.getItem("refreshToken")},dr={isLoading:!1,isError:!1,orders:[]},lr={isLoading:!1,isError:!1,orders:[]},ur={orders:{}},_r=Object(rr.b)({order:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:sr,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case pe:return Object(y.a)(Object(y.a)({},e),{},{orderNumberRequest:!0});case H:return Object(y.a)(Object(y.a)({},e),{},{orderNumberRequest:!1,orderNumberFailed:!1,order:t.payload.order});case Oe:return Object(y.a)(Object(y.a)({},sr),{},{orderNumberFailed:!0});case be:return Object(y.a)(Object(y.a)({},e),{},{order:null});default:return e}},ingredients:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:cr,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case oe:return Object(y.a)(Object(y.a)({},e),{},{ingredientsFailed:!1,ingredientsRequest:!0});case de:return Object(y.a)(Object(y.a)({},e),{},{ingredientsFailed:!1,ingredientsRequest:!1,ingredients:t.payload.ingredients});case le:return Object(y.a)(Object(y.a)({},cr),{},{ingredientsFailed:!0});case ue:return Object(y.a)(Object(y.a)({},e),{},{selectedIngredient:t.payload.ingredient});case ie:return Object(y.a)(Object(y.a)({},e),{},{selectedIngredient:null});default:return e}},burgerConstructor:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ar,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case H:return Object(y.a)(Object(y.a)({},e),{},{selectedIngredients:[],selectedBun:null});case V:var r=t.payload.ingredient;return"bun"===r.type?Object(y.a)(Object(y.a)({},e),{},{selectedBun:r}):Object(y.a)(Object(y.a)({},e),{},{selectedIngredients:[].concat(Object(nr.a)(e.selectedIngredients),[r])});case q:return Object(y.a)(Object(y.a)({},e),{},{selectedIngredients:e.selectedIngredients.filter((function(e,r){return r!==t.payload.deleteIndex}))});case Y:var n=t.payload,a=n.dragIndex,c=n.itemIndex,s=Object(nr.a)(e.selectedIngredients),i=s[a];return s[a]=s[c],s[c]=i,Object(y.a)(Object(y.a)({},e),{},{selectedIngredients:s});default:return e}},user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:or,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Ce:var r,n,a;return Object(y.a)(Object(y.a)({},e),{},{email:null!==(r=t.payload.email)&&void 0!==r?r:e.email,password:null!==(n=t.payload.password)&&void 0!==n?n:e.password,name:null!==(a=t.payload.name)&&void 0!==a?a:e.name});case Te:var c,s;return Object(y.a)(Object(y.a)({},e),{},{email:null!==(c=t.payload.email)&&void 0!==c?c:e.email,password:null!==(s=t.payload.password)&&void 0!==s?s:e.password});case we:return Object(y.a)(Object(y.a)({},e),{},{loggedIn:!0});case Se:return Object(y.a)(Object(y.a)({},e),{},{email:"",password:"",loggedIn:!1});case Re:var i,o;return Object(y.a)(Object(y.a)({},e),{},{email:null!==(i=t.payload.email)&&void 0!==i?i:e.email,name:null!==(o=t.payload.name)&&void 0!==o?o:e.name});case De:var d,l,u;return Object(y.a)(Object(y.a)({},e),{},{email:null!==(d=t.payload.email)&&void 0!==d?d:e.email,name:null!==(l=t.payload.name)&&void 0!==l?l:e.name,password:null!==(u=t.payload.password)&&void 0!==u?u:e.password});default:return e}},resetPassword:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ir,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case ze:return Object(y.a)(Object(y.a)({},e),{},{email:t.payload.email});case We:return Object(y.a)(Object(y.a)({},e),{},{email:""});default:return e}},feed:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:dr,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case ht:return Object(y.a)(Object(y.a)({},e),{},{isLoading:!0,isError:!1});case yt:return Object(y.a)(Object(y.a)({},e),{},{isLoading:!1,isError:!0});case vt:return Object(y.a)(Object(y.a)({},e),{},{isError:!1});case Nt:var r=t.payload.data,n=r.orders,a=r.total,c=r.totalToday;return Object(y.a)(Object(y.a)({},e),{},{orders:n,total:a,totalToday:c,isLoading:!1});default:return e}},profileFeed:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:lr,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case kt:return Object(y.a)(Object(y.a)({},e),{},{isLoading:!0,isError:!1});case Et:return Object(y.a)(Object(y.a)({},e),{},{isLoading:!1,isError:!0});case It:return Object(y.a)(Object(y.a)({},e),{},{isError:!1});case Ct:var r=t.payload.data.orders;return Object(y.a)(Object(y.a)({},e),{},{orders:r,isLoading:!1});default:return e}},orders:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ur,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Nt:case Ct:var r=t.payload.data.orders;return Object(y.a)(Object(y.a)({},e),{},{orders:Object(y.a)(Object(y.a)({},e.orders),r.reduce((function(e,t){return Object(y.a)(Object(y.a)({},e),{},Object(v.a)({},t._id,t))}),{}))});default:return e}}}),jr=er(Object(rr.a)(tr.a,(Xt={init:ft,send:"WS_SEND_MESSAGE",close:gt},function(e){var t={};return function(r){return function(n){var a=e.dispatch,c=n.type;if(c===Xt.init){var s=n.payload,i=s.wsUrl,o=s.id,d=s.actions;if(t[o])return r(n);var l=new WebSocket(i);t[o]={socket:l,id:o,wsUrl:i,actions:d},console.log("wsMiddleware","socket created",{socket:l,id:o,wsUrl:i,actions:d}),a({type:d.start}),l.onopen=function(e){console.log("wsMiddleware","socket open event",{id:o,event:e}),a({type:d.open})},l.onerror=function(e){console.log("wsMiddleware","socket error event",o,e),a({type:d.error}),t[o]&&(t[o].socket.close(),delete t[o],console.log("wsMiddleware","connection deleted",{id:o}))},l.onmessage=function(e){var r=JSON.parse(e.data);console.log("wsMiddleware","message event",{data:r}),r.success?a({type:d.message,payload:{data:r}}):(a({type:d.error}),t[o]&&(t[o].socket.close(),delete t[o],console.log("wsMiddleware","connection deleted",{id:o})))},l.onclose=function(e){console.log("wsMiddleware","close event",{id:o,event:e}),a({type:d.close}),t[o]&&(delete t[o],console.log("wsMiddleware","connection deleted",{id:o}))}}if(c===Xt.send){var u=n.payload,_=u.message,j=u.id,m=t[j];m&&m.socket.send(JSON.stringify(_))}if(c===Xt.close){var b=n.payload.id,p=t[b];p&&(p.socket.close(),delete t[b])}r(n)}}}))),mr=Object(rr.d)(_r,jr);s.a.render(Object(O.jsx)(a.a.StrictMode,{children:Object(O.jsx)(N.a,{store:mr,children:Object(O.jsx)(Qt.a,{backend:$t.a,children:Object(O.jsx)(Zt,{})})})}),document.getElementById("root")),Kt()},27:function(e,t,r){e.exports={order_card:"order-card_order_card__2JN1n",order_number:"order-card_order_number__2I4BD",order_ingredients:"order-card_order_ingredients__Myu-h",order_ingredients_images:"order-card_order_ingredients_images__2c3Y8",order_images_border:"order-card_order_images_border__3RORT",order_ingredient_image:"order-card_order_ingredient_image__14WKn",order_icon:"order-card_order_icon__1Xnad",order_ingredient_count:"order-card_order_ingredient_count__2cOB_"}},34:function(e,t,r){e.exports={header:"header_header__2PCJV",nav:"header_nav__Yn7D9",navLink:"header_navLink__2qrHS",active_link:"header_active_link__1bgGB"}},36:function(e,t,r){e.exports={main:"profile_main__242OX",nav:"profile_nav__B_z69",active_link:"profile_active_link__MU5sa",navlink:"profile_navlink__1MZdx",logout:"profile_logout__3chQM",form:"profile_form__3ORnl"}},41:function(e,t,r){e.exports={constructor_section:"burger-constructor_constructor_section__3FdfH",constructor_list:"burger-constructor_constructor_list__2mBcy",constructor_items:"burger-constructor_constructor_items__2t2yl",order:"burger-constructor_order__SsnH4",scrollbox:"burger-constructor_scrollbox__3Z23P",scrollbar:"burger-constructor_scrollbar__-c9tN"}},53:function(e,t,r){e.exports={ingredients_section:"burger-ingredients_ingredients_section__l8mYY",ingredients_tabs:"burger-ingredients_ingredients_tabs__1zFeW",scrollbox:"burger-ingredients_scrollbox__2apTV",scrollbar:"burger-ingredients_scrollbar__2rVSV"}},54:function(e,t,r){e.exports={details:"ingredient-details_details__28kCX",content:"ingredient-details_content__1TZrm",image:"ingredient-details_image__3EkJL",list:"ingredient-details_list__3jN0U"}},67:function(e,t,r){e.exports={modal:"modal_modal__-GJUR",header:"modal_header__2r55q",close:"modal_close__VSo9S"}},68:function(e,t,r){e.exports={ingredients_list:"ingredients-section_ingredients_list__1mz_n",ingredients_list_title:"ingredients-section_ingredients_list_title__2YZ9h",cards_box:"ingredients-section_cards_box__1j8gA"}},69:function(e,t,r){e.exports={constructor_item:"burger-constructor-item_constructor_item__N6dYK",ingredient_button:"burger-constructor-item_ingredient_button__1wYRz",drag_button:"burger-constructor-item_drag_button__2w73P"}},70:function(e,t,r){e.exports={details:"order-details-modal_details__1AqgF",checkmark:"order-details-modal_checkmark__27n_U",digits:"order-details-modal_digits__30q67"}},90:function(e,t,r){e.exports={ingredient_card:"ingredient-card_ingredient_card__1DunG",price:"ingredient-card_price__zyJet"}}},[[217,1,2]]]);
//# sourceMappingURL=main.a10fc272.chunk.js.map